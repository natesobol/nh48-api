<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!-- Favicons - ICO format preferred for Google compatibility -->
<link rel="icon" href="/favicons/favicon.ico" sizes="48x48" />
<link rel="icon" type="image/x-icon" href="/favicons/favicon.ico" />
<link rel="shortcut icon" href="/favicons/favicon.ico" />
<link rel="icon" type="image/x-icon" sizes="16x16" href="/favicons/favicon-16x16.ico" />
<link rel="icon" type="image/x-icon" sizes="32x32" href="/favicons/favicon-32x32.ico" />
<link rel="icon" type="image/x-icon" sizes="48x48" href="/favicons/favicon-48x48.ico" />
<link rel="icon" type="image/x-icon" sizes="96x96" href="/favicons/favicon-96x96.ico" />
<!-- PNG fallbacks for browsers that prefer PNG -->
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32.png" />
<link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/favicons/favicon-96x96.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
<link rel="manifest" href="/manifest.json" />
<title>Howker Ridge • Trail Plant Catalog</title>
<meta name="description" content="Interactive alpine plant catalog for Howker Ridge (Mount Madison, NH). Browse quick facts, habitats, elevation ranges, and seasonal notes. Click a plant for details." />
<meta name="keywords" content="Howker Ridge Trail plant catalog, alpine plants, subalpine flora, Mount Madison, New Hampshire, White Mountains, plant catalog, NH48" />
<link rel="canonical" href="https://nh48.info/plant-catalog" />
<link rel="alternate" hreflang="en" href="https://nh48.info/plant-catalog" />
<link rel="alternate" hreflang="fr" href="https://nh48.info/fr/plant-catalog" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Howker Ridge • Alpine &amp; Subalpine Plant Catalog" />
<meta property="og:description" content="Interactive catalog documenting alpine and subalpine plants along the Howker Ridge Trail on Mount Madison, NH." />
<meta property="og:url" content="https://nh48.info/plant-catalog" />
<meta property="og:image" content="https://photos.nh48.info/cdn-cgi/image/format=jpg,quality=85,width=1200/mount-madison/mount-madison__003.jpg" />
<meta property="og:image:alt" content="Mount Madison ridge view with alpine terrain and distant peaks" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Howker Ridge • Alpine &amp; Subalpine Plant Catalog" />
<meta name="twitter:description" content="Search, filter, and browse alpine plant observations from the Howker Ridge Trail with detailed species pages." />
<meta name="twitter:image" content="https://photos.nh48.info/cdn-cgi/image/format=jpg,quality=85,width=1200/mount-madison/mount-madison__003.jpg" />
<meta name="twitter:image:alt" content="Mount Madison ridge view with alpine terrain and distant peaks" />
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "Howker Ridge Alpine & Subalpine Plant Catalog",
    "description": "Interactive catalog documenting alpine and subalpine species along the Howker Ridge Trail on Mount Madison in the White Mountains of New Hampshire.",
    "url": "https://nh48.info/plant-catalog",
    "isPartOf": {
      "@type": "WebSite",
      "name": "NH48 API",
      "url": "https://nh48.info/"
    },
    "breadcrumb": {
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://nh48.info/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Projects",
          "item": "https://nh48.info/projects"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "Howker Ridge Plant Catalog",
          "item": "https://nh48.info/plant-catalog"
        }
      ]
    },
    "mainEntity": {
      "@type": "Dataset",
      "name": "Howker Ridge Plant Catalog Dataset",
      "description": "Structured JSON records for alpine and subalpine plants observed on the Howker Ridge Trail.",
      "url": "https://nh48.info/data/howker-plants",
      "distribution": [
        {
          "@type": "DataDownload",
          "encodingFormat": "application/json",
          "contentUrl": "https://nh48.info/data/howker-plants"
        }
      ]
    }
  }
</script>
<script type="application/ld+json" class="plant-list">
  {
    "@context": "https://schema.org",
    "@type": "ItemList",
    "name": "Howker Ridge Plant Catalog",
    "itemListElement": []
  }
</script>
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Place",
    "name": "Howker Ridge Trail",
    "description": "Steep ridge trail on Mount Madison in the White Mountains of New Hampshire.",
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Randolph",
      "addressRegion": "NH",
      "addressCountry": "US"
    },
    "geo": {
      "@type": "GeoCoordinates",
      "latitude": 44.334951,
      "longitude": -71.266614
    }
  }
</script>
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "NH48 – White Mountains Hiking Guide",
    "url": "https://nh48.info/",
    "publisher": {
      "@type": "Organization",
      "name": "NH48 Project",
      "url": "https://nh48.info/",
      "logo": {
        "@type": "ImageObject",
        "url": "https://nh48.info/assets/logo.png",
        "width": 512,
        "height": 512
      }
    }
  }
</script>
<script>
  (() => {
    if (window.NH48_BUILD_DATE) return;
    try {
      const xhr = new XMLHttpRequest();
      xhr.open('GET', '/build-meta.json', false);
      xhr.send(null);
      if (xhr.status >= 200 && xhr.status < 300) {
        const meta = JSON.parse(xhr.responseText);
        if (meta && meta.buildDate) {
          window.NH48_BUILD_DATE = meta.buildDate;
        }
      }
    } catch (err) {
      // No-op: build date is optional in static builds.
    }
  })();
</script>
<script src="/js/unified-footer.js" defer></script>

<style>

/****************************
 * THEME VARIABLES
 ****************************/
:root{
  /* Dark theme palette
     - bg: background color of the page
     - panel/card: surfaces for panels and cards
     - ink: primary text color
     - muted: secondary text color
     - stroke: border color (forced pure white here)
     - accent: highlight color used for active states
     - gap: base spacing unit for components */
  --bg:#0a0a0a;
  --panel:#12121a;
  --card:#171a22;
  --ink:#ffffff;
  --muted:#a5b4c3;
  --stroke:#ffffff;
  --accent:#22c55e;
  --gap:10px;
}
/* Light theme overrides applied when body has class "light" */
body.light{
  --bg:#f8fafc;
  --panel:#ffffff;
  --card:#f7f9fc;
  --ink:#1f2937;
  --muted:#6b7280;
  --stroke:#00000022;
  --accent:#22c55e;
}

/****************************
 * GLOBAL RESETS & BASICS
 ****************************/
*{ box-sizing:border-box; }
html{
  min-width:320px;
  scroll-behavior:smooth;
}
@media (prefers-reduced-motion: reduce){
  html{ scroll-behavior:auto; }
}
body{
  margin:0;
  background:var(--bg);
  color:var(--ink);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
  overflow:auto; /* allow the page to scroll, avoid nested page-level scrolls */
}

/****************************
 * LAYOUT CONTAINERS
 ****************************/
/* Wrapper to constrain content width and provide horizontal padding */
.wrap{
  max-width:1100px;
  margin:0 auto;
  padding:12px;
}
/* Main panel surface with white border and slight shadow */
.panel{
  background:var(--panel);
  border:none;
  border-radius:10px;
  margin-top:1.5rem;
  padding:16px;
  box-shadow:0 10px 30px #0004;
  overflow:hidden;
}

/****************************
 * TYPOGRAPHY
 ****************************/
header h1{
  margin:0 0 8px;
  font-size:clamp(20px,3.2vw,28px);
  letter-spacing:.2px;
  line-height:1.2;
}
header p{
  margin:0;
  color:var(--muted);
}

.page-breadcrumbs{
  margin:6px 0 16px;
  font-size:13px;
  color:var(--muted);
}
.page-breadcrumbs ol{
  list-style:none;
  padding:0;
  margin:0;
  display:flex;
  flex-wrap:wrap;
  gap:6px;
}
.page-breadcrumbs li::after{
  content:"/";
  margin-left:6px;
  color:var(--muted);
}
.page-breadcrumbs li:last-child::after{
  content:"";
}
.page-breadcrumbs a{
  color:inherit;
  text-decoration:none;
}
.page-breadcrumbs a:hover{
  color:var(--accent);
}
.text-guide{
  font-size:0.9rem;
  margin:0 0 1rem;
}
.text-green{ color:#388e3c; }
.text-yellow{ color:#fbc02d; }
.text-red{ color:#d32f2f; }

/****************************
 * LATEST UPDATES DROPDOWN
 ****************************/
.updates-dropdown{
  margin:16px 0 20px;
  border:2px solid var(--stroke);
  border-radius:12px;
  overflow:hidden;
  background:linear-gradient(180deg, #0f121a 0%, #0b0d14 100%);
}
.updates-dropdown summary{
  list-style:none;
  cursor:pointer;
  padding:12px 16px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  font-weight:700;
  color:var(--accent);
}
.updates-dropdown summary::-webkit-details-marker{
  display:none;
}
.updates-dropdown summary::before{
  content:"▸";
  display:inline-block;
  transform:rotate(0deg);
  transition:transform 0.2s ease;
  color:var(--accent);
  margin-right:8px;
}
.updates-dropdown[open] summary::before{
  transform:rotate(90deg);
}
.updates-dropdown summary .summary-title{
  display:flex;
  align-items:center;
  gap:8px;
}
.updates-dropdown .summary-action{
  font-size:12px;
  padding:6px 14px;
  border-radius:999px;
  border:1px solid transparent;
  background:var(--accent);
  color:#0a0a0a;
  text-decoration:none;
  font-weight:700;
  white-space:nowrap;
}
.updates-dropdown .summary-action:hover{
  filter:brightness(0.95);
}
.updates-dropdown .updates-body{
  border-top:1px solid #ffffff33;
  padding:8px 16px 16px;
  display:grid;
  gap:12px;
}
.updates-dropdown .update-entry{
  border:1px solid #ffffff33;
  border-radius:10px;
  padding:12px 14px;
  background:rgba(18, 18, 26, 0.7);
}
.updates-dropdown .update-entry.latest{
  border-color:rgba(143, 233, 255, 0.7);
  background:linear-gradient(140deg, rgba(27, 53, 68, 0.9), rgba(18, 18, 26, 0.8));
  box-shadow:0 0 0 1px rgba(143, 233, 255, 0.3);
}
.updates-dropdown .update-marker{
  display:inline-flex;
  align-items:center;
  gap:6px;
  margin-left:10px;
  font-size:11px;
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:0.06em;
  padding:2px 8px;
  border-radius:999px;
  background:rgba(143, 233, 255, 0.18);
  color:#bfefff;
}
.updates-dropdown .updates-divider{
  display:flex;
  align-items:center;
  gap:12px;
  color:var(--muted);
  font-size:12px;
  text-transform:uppercase;
  letter-spacing:0.12em;
  margin:2px 2px 0;
}
.updates-dropdown .updates-divider::before,
.updates-dropdown .updates-divider::after{
  content:"";
  flex:1;
  height:1px;
  background:rgba(255, 255, 255, 0.18);
}
.updates-dropdown .update-entry h3{
  margin:0 0 6px;
  font-size:14px;
}
.updates-dropdown .update-entry p{
  margin:0;
  color:var(--muted);
  line-height:1.5;
}
.updates-dropdown .update-entry strong{
  color:var(--ink);
}

.catalog-meta{
  margin-top:24px;
  border-top:1px dashed var(--stroke);
  padding-top:18px;
  display:grid;
  gap:16px;
}
.catalog-meta h2{
  margin:0 0 6px;
  font-size:18px;
}
.catalog-meta h3{
  margin:0 0 6px;
  font-size:16px;
}
.catalog-meta p{
  margin:0 0 10px;
  color:var(--muted);
}
.catalog-meta ul{
  margin:0;
  padding-left:18px;
  color:var(--muted);
}
@media(min-width:860px){
  .catalog-meta{
    grid-template-columns:1fr 1fr;
  }
}

/****************************
 * FILTER CONTROLS
 ****************************/
/* Controls layout: grid of inputs/selects */
.controls{
  display:grid;
  gap:10px;
  margin:14px 0;
}
@media(min-width:860px){
  .controls{ grid-template-columns:1.2fr .8fr .8fr .6fr; }
}
.ctrl{
  display:flex;
  align-items:center;
}
.ctrl input,
.ctrl select{
  width:100%;
  height:42px;
  border:1px solid var(--stroke);
  border-radius:12px;
  background:var(--card);
  color:var(--ink);
  padding:0 14px;
  outline:none;
  min-width:0;
}
.ctrl input::placeholder{
  color:var(--muted);
}

/****************************
 * SETTINGS PANEL
 ****************************/
/* Outer settings container with subtle shadow */
.settings{
  background:var(--panel);
  border:1px solid var(--stroke);
  border-radius:12px;
  padding:18px;
  box-shadow:0 4px 12px #0003;
  margin-bottom:16px;
  max-width:100%;
}
/* Settings logo/title line */
.settings-logo{
  font-size:18px;
  font-weight:bold;
  margin-bottom:12px;
  color:var(--accent);
  display:flex;
  align-items:center;
  gap:8px;
}
.settings-icon{
  font-size:20px;
}
/* Each row containing a checkbox and label */
.setting-row{
  display:flex;
  align-items:center;
  gap:8px;
  margin-top:10px;
  font-size:14px;
  color:var(--muted);
}
.setting-row input{
  width:18px;
  height:18px;
  cursor:pointer;
}
/* Desktop layout: align settings horizontally with spacing */
@media (min-width: 760px){
  .settings{
    display:flex;
    align-items:center;
    justify-content:flex-start;
    flex-wrap:wrap;
    gap:22px 26px;
  }
  .settings-logo{
    margin-bottom:0;
    margin-right:18px;
    padding-right:18px;
    border-right:1px solid var(--stroke);
  }
  .setting-row{
    margin-top:0;
    flex:0 0 auto;
  }
}

/****************************
 * GRID OF CARDS
 ****************************/
/* Base grid for plant cards */
.grid{
  display:grid;
  gap:12px;
  min-height:160px;
}
@media(min-width:760px){
  .grid{ grid-template-columns:repeat(3,1fr); }
}
/* Individual plant card */
.card{
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:12px;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  min-height:280px;
  cursor:pointer;
  transition:transform .12s ease, box-shadow .12s ease;
  position:relative; /* anchor for arrow icon */
}
.card:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 20px #0005;
}
/* Thumbnail area retains 5:3 aspect ratio and uses dashed separator */
.thumb{
  aspect-ratio:5/3;
  height:auto;
  overflow:hidden;
  border-bottom:1px dashed var(--stroke);
  position:relative;
}
.thumb img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
  transition: opacity 0.6s ease;
}
/* Card body content */
.card .body{
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:8px;
  overflow-wrap:break-word;
  hyphens:auto;
}
.card h3{
  margin:0;
  font-size:16px;
  line-height:1.2;
}
.card .latin{
  color:var(--muted);
  font-style:italic;
  font-size:13px;
}
.meta{
  display:grid;
  gap:6px;
  margin-top:4px;
  padding-top:6px;
  border-top:1px dashed #ffffff33;
}
.meta-row{
  display:flex;
  align-items:flex-start;
  gap:8px;
  font-size:12px;
  color:var(--muted);
  border-bottom:1px dotted #ffffff26;
  padding-bottom:6px;
}
.meta-row:last-child{
  border-bottom:none;
  padding-bottom:0;
}
.meta-label{
  min-width:72px;
  text-transform:uppercase;
  letter-spacing:.08em;
  font-size:10px;
  color:var(--accent);
}
.meta-value{
  color:var(--ink);
  font-weight:600;
  flex:1;
}
.meta-tags{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
}
.tag-pill{
  border:1px solid #22c55e66;
  color:#22c55e;
  padding:2px 6px;
  border-radius:999px;
  font-size:10px;
  letter-spacing:.02em;
  text-transform:uppercase;
}
.teaser-block{
  margin-top:6px;
  padding-top:6px;
  border-top:1px dashed #ffffff26;
}
.teaser-label{
  text-transform:uppercase;
  letter-spacing:.08em;
  font-size:10px;
  color:var(--accent);
}
.teaser{
  margin:4px 0 0;
  font-size:12.5px;
  color:var(--ink);
}
/* Arrow indicator pinned bottom right of card */
.card .more{
  position:absolute;
  bottom:var(--gap);
  right:var(--gap);
  font-size:16px;
  color:var(--accent);
  pointer-events:none;
}

/****************************
 * VIEW MODE OVERRIDES
 ****************************/
/* List view: cards become horizontal rows */
body.list-view .grid{
  display:flex;
  flex-direction:column;
}
body.list-view .card{
  flex-direction:row;
  min-height:80px;
}
body.list-view .thumb{
  width:120px;
  height:80px;
  border-right:1px dashed var(--stroke);
  border-bottom:none;
}
body.list-view .body{
  flex:1;
}
/* Compact mode reduces padding and chip sizes */
body.compact .card .body{
  padding:8px;
}
body.compact .tag-pill{
  font-size:9px;
}
body.compact .card{
  min-height:240px;
}
/* Apply to the whole page so no horizontal scroll is possible */
html, body {
  overflow-x: hidden;
}

/* Drawer defaults: no margin and 100% translation so it doesn’t add width */
.drawer {
  margin: 0;
  width: 100%;               /* full viewport width */
  height: 100dvh;            /* full viewport height */
  transform: translateX(100%); /* completely off-screen when closed */
}

/* When the drawer opens, translate back to origin */
.drawer.open {
  transform: translateX(0);
}

/* Optional: for small screens, you can collapse the border/margins further */
@media (max-width: 480px) {
  .drawer {
    border-radius: 0;
    border-left: none;
  }
}

/****************************
 * STICKY HEADER SUPPORT
 ****************************/
header.sticky{
  position:sticky;
  top:0;
  z-index:20;
  background:var(--panel);
  padding-top:10px;
  padding-bottom:10px;
}

/****************************
 * FOOTER & MESSAGES
 ****************************/
.footer{
  margin-top:12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  color:var(--muted);
  font-size:12px;
  gap:8px;
  flex-wrap:wrap;
}
.empty,
.error,
.loading{
  color:var(--muted);
  text-align:center;
  padding:24px;
  border:1px dashed var(--stroke);
  border-radius:10px;
}

/****************************
 * PREVENT HORIZONTAL SCROLL
 ****************************/
html,
body,
#howker-plants{
  overflow-x:hidden;
}

/****************************
 * PAGINATION UI (cleaned)
 ****************************/
/* The pager consists of two columns: left for stats, right for page controls.  
   A CSS grid is used for robust centering of the page controls while keeping
   stats text aligned left. Adjust gap and margins to maintain rhythm. */
.pager-wrap{
  display:grid;
  grid-template-columns:auto 1fr;
  align-items:center;
  gap:10px;
  margin:16px 0;
  padding:6px 0;
}
.pager-left{
  justify-self:start;
}
.pager-stats{
  color:var(--muted);
  font-size:12px;
  white-space:nowrap;
}
.pager-right{
  justify-self:center;
}
.page-list{
  display:flex;
  gap:6px;
  flex-wrap:nowrap;
  justify-content:center;
}
/* Base page button styling */
.page-btn{
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:10px;
  min-width:34px;
  height:34px;
  display:grid;
  place-items:center;
  cursor:pointer;
  color:var(--ink);
}
.page-btn[aria-current="page"]{
  border-color:var(--accent);
  outline:2px solid #22c55e55;
  color:#ffffff;
}

/* Hide pagination controls when showing all plants on a single page */
.pager-wrap{
  display:none !important;
}

/* Hide the main catalog when details pane is open */
body.details-open #howker-plants {
  display: none;
}

/* Drawer hidden by default */
.drawer {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  margin: 0;
  border-left: none;
  border-radius: 0;
  z-index: 1000;           /* ensures it overlays everything */
  transform: translateX(0);/* no slide animation on mobile */
}

/* Show the drawer when it's both .open and the body has .details-open */
body.details-open .drawer.open {
  display: flex;
}

/****************************
 * RESPONSIVE BREAKPOINTS
 ****************************/
@media (max-width:480px){
  :root{
    --edge:max(10px, env(safe-area-inset-left), env(safe-area-inset-right));
  }
  .wrap{
    padding:0;
  }
  .panel{
    width:calc(100% - (2 * var(--edge)));
    margin-inline:var(--edge);
    max-width:none;
    border-radius:10px;
  }
  .grid{
    grid-template-columns:1fr;
    justify-items:center;
  }
  .card{
    width:min(100%, 360px);
  }
  .ctrl input,
  .ctrl select{
    height:44px;
    padding:0 16px;
    border-radius:14px;
  }
  .chip{
    font-size:11px;
  }
  /* Pagination on mobile: reduce button sizes and spacing */
  .pager-wrap{
    margin:14px 0;
    padding:4px 0;
  }
  .pager-stats{
    font-size:11px;
  }
  .page-list{
    gap:4px;
  }
  .page-btn{
    min-width:26px;
    height:26px;
    font-size:12px;
    border-radius:8px;
  }
  /* Buttons in controls (not page) shrink on mobile */
  .pager button,
  .pager-select{
    height:30px;
    min-width:30px;
    padding:6px 8px;
    border-radius:8px;
  }
}

@media (max-width:320px){
  :root{
    --edge:max(8px, env(safe-area-inset-left), env(safe-area-inset-right));
  }
  .panel{
    width:calc(100% - (2 * var(--edge)));
    margin-inline:var(--edge);
    border-radius:10px;
  }
  .ctrl input,
  .ctrl select{
    height:42px;
  }
  header h1{
    font-size:20px;
  }
  .card{
    width:100%;
  }
  .chip{
    font-size:10.5px;
  }
}

/* Spinner overlay for plant catalog thumbnails */
.thumb-loading{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
}
.thumb-loading.hidden{ display:none; }
/* Small green loading wheel (25px) — matches peak spinner style */
.thumb-loading .loading-spinner{
  width:25px;
  height:25px;
  border-radius:50%;
  border:3px solid rgba(34, 197, 94, 0.25);
  border-top-color:var(--accent);
  animation:spin 0.9s linear infinite;
}
/* Spinner keyframes (if not already defined) */
@keyframes spin{ to{ transform:rotate(360deg); } }

</style>

</head>
<body data-route="plant-catalog" data-page="plant-catalog">
  <div id="nav-placeholder"></div>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const navPlaceholder = document.getElementById('nav-placeholder');
      const activeRoute = document.body.dataset.route || document.body.dataset.page;

      if (navPlaceholder) {
        fetch('/pages/nav.html')
          .then(response => response.text())
          .then(html => {
            navPlaceholder.innerHTML = html;
            const links = navPlaceholder.querySelectorAll('.site-nav-links a');
            links.forEach(link => {
              const routes = (link.dataset.routes || link.dataset.route || '')
                .split(',')
                .map(value => value.trim())
                .filter(Boolean);

              if (routes.includes(activeRoute)) {
                link.classList.add('active');
                link.setAttribute('aria-current', 'page');
              }
            });
            if (window.NH48_I18N && window.NH48_I18N.refreshLangPicker) {
              window.NH48_I18N.refreshLangPicker();
            }
          })
          .catch(err => console.error('Failed to load navigation:', err));
      }
    });
  </script>
<!-- data-site-origin ensures Editor/Preview loads entries -->
<div class="wrap panel" id="howker-plants">
  <header>
    <blockquote>
      <h1>Howker Ridge • Sub &amp; Alpine Plant Catalog</h1>
    </blockquote>
    <blockquote>
      <p>Browse alpine/subalpine species and communities observed along Howker Ridge Trail. Click a card for detailed information. Disclosure Information compiled w/ AI. Purely for exploration &amp; may not be completely accurate. This log should be refined &amp; updated over time as I continue to work safely as the Trail Adopter.</p>
    </blockquote>
  </header>
  <nav class="page-breadcrumbs" aria-label="Breadcrumb">
    <ol>
      <li><a href="/">Home</a></li>
      <li><a href="/plant-catalog">Projects</a></li>
      <li>Howker Ridge Plant Catalog</li>
    </ol>
  </nav>
  <details class="updates-dropdown">
    <summary>
      <span class="summary-title">Latest Plant Log Updates</span>
      <a class="summary-action" href="https://nh48.info/projects/hrt-info" target="_blank" rel="noopener">Trail Info</a>
    </summary>
    <div class="updates-body">
      <article class="update-entry latest">
        <h3>Jan 23 2026 — Migration to nh48.info &amp; recent improvements <span class="update-marker">Most recent</span></h3>
        <p>Migrated the Howker Ridge plant catalog to <strong>nh48.info</strong> and centralized photo database for faster loading and public access into another dataset. Recent improvements include expanded species metadata, refined habitat tags, higher-quality photo references, and a cleaner browsing layout.</p>
      </article>
      <div class="updates-divider" aria-hidden="true">Earlier updates</div>
      <article class="update-entry">
        <h3>Nov 12 2025 — Late-season alpine updates</h3>
        <p>Added late fall plant observations, cleaned up notes, and refreshed habitat tags based on recent trail surveys and photo reviews.</p>
      </article>
      <article class="update-entry">
        <h3>Sept 1 2025 — Why this catalog exists</h3>
        <p>After hiking the Howker Ridge Trail on Mount Madison, I became captivated by the unique geology and location of the Howker Ridge Trail. Traversing an incredibly diverse set of ecosystems ascending Mt. Madison, the trail hosts a uniquely diverse set of ecosystems I’d argue, hard to find this close together anywhere in New England, I’m working on photographing, documenting, and in the future recording exact locations of some of these plants with conservation and alpine regulations in mind. Howker Ridge, like many areas in the White Mountains was subject to different levels of logging which adds a layer of complexity.</p>
      </article>
    </div>
  </details>
  <!-- Settings panel -->
<aside class="settings" id="settings-panel">
  <div class="settings-logo">Settings</div>
  <div class="setting-row">
    <input type="checkbox" id="theme-toggle" checked>
    <label for="theme-toggle">Dark theme</label>
  </div>
  <div class="setting-row">
    <input type="checkbox" id="view-toggle">
    <label for="view-toggle">List view</label>
  </div>
  <div class="setting-row">
    <input type="checkbox" id="rotate-toggle" checked>
    <label for="rotate-toggle">Rotate images</label>
  </div>
  <div class="setting-row">
    <input type="checkbox" id="compact-toggle">
    <label for="compact-toggle">Compact view</label>
  </div>
  <div class="setting-row">
    <input type="checkbox" id="sticky-toggle">
    <label for="sticky-toggle">Sticky header</label>
  </div>
</aside>


  <div class="controls">
    <label class="ctrl"><input id="q" placeholder="Name, latin, tag, habitat…"></label>
    <label class="ctrl">
      <select id="type">
        <option value="">All types</option>
        <option>Shrub</option><option>Wildflower</option><option>Moss</option>
        <option>Lichen</option><option>Forest</option><option>Community</option><option>Fungus</option>
      </select>
    </label>
    <label class="ctrl">
      <select id="habitat">
        <option value="">Any habitat</option>
        <option>Alpine heath</option><option>Krumholz</option><option>Talus/boulder</option>
        <option>Spruce–fir forest</option><option>Moist ravine</option>
      </select>
    </label>
    <label class="ctrl">
      <select id="bloom">
        <option value="">Any season</option>
        <option>Late spring</option><option>Summer</option><option>Non-flowering</option>
      </select>
    </label>
  </div>

  <!-- Pagination header (Top) -->
  <div class="pager-wrap">
    <div class="pager-left">
      <div class="pager-stats" id="pager-stats-top">Showing —</div>
    </div>
    <div class="pager-right">
      <div class="page-list" id="page-list-top" aria-label="Pagination"></div>
    </div>
  </div>

  <div id="grid" class="grid" aria-live="polite">
    <div class="loading" id="loading">Loading plant catalog…</div>
  </div>

  <!-- Pagination footer (Bottom) -->
  <div class="pager-wrap">
    <div class="pager-left">
      <div class="pager-stats" id="pager-stats-bot">Showing —</div>
    </div>
    <div class="pager-right">
      <div class="page-list" id="page-list-bot" aria-label="Pagination"></div>
    </div>
  </div>

  <div class="footer">
    <span>Unofficial &amp; volunteer • Howker Ridge Trail Sub &amp; Alpine Plant Catalog</span>
    <span>© <span id="year"></span> Nathan Sobol • NH48pics</span>
  </div>
</div>

<script>
  /* =============================================================
     HOWKER RIDGE — APP CORE (single scroll + pagination @ 20)
     Implements 5-step plan:
       1) Pagination (20 / page) + page owns scrolling
       2) Dynamic viewport units (100dvh) for drawer
       3) overscroll-behavior containment on internal scroller
       4) Robust body-lock utility (disabled by default)
       5) Safer iframe auto-resize for Wix (postMessage)
     Also includes: pure-white borders & one-line mobile pager
     ============================================================= */

  /* ---------- Data & State ---------- */
  let PLANTS = [];
  let CURRENT = [];           // filtered list
  let PAGE = 1;               // 1-based
  // Show all entries on one continuous page by using a very large page size.
  // Number.MAX_SAFE_INTEGER ensures PAGE_SIZE exceeds the number of catalog items.
  const DEFAULT_PAGE_SIZE = Number.MAX_SAFE_INTEGER;
  let PAGE_SIZE = DEFAULT_PAGE_SIZE;
  let TOTAL_PAGES = 1;

  // Mapping: page => [start,end) indices
  const pageBounds = (page, size, total) => {
    const p = Math.max(1, Math.min(page, Math.max(1, Math.ceil(total / size) || 1)));
    const start = (p - 1) * size;
    const end = Math.min(start + size, total);
    return { p, start, end };
  };

  // Carousel state
  let carouselTimer = null;   // setInterval handle
  let carouselIdx = 0;        // active index
  let carouselImgs = [];      // img elements
  let carouselDelay = 4000;   // default ~4s (3–5s jitter)

  // Rotation control for cards
  let rotateInterval = null;

  // DOM helpers
  const $ = s => document.querySelector(s);
  const grid = $("#grid");
  // Removed reference to drawer on the catalog page. We will redirect instead.
  const qEl=$("#q"), typeEl=$("#type"), habEl=$("#habitat"), bloomEl=$("#bloom");
  const drawerContent = null; // no drawer on this page
  const themeToggle = document.getElementById('theme-toggle');
  const viewToggle  = document.getElementById('view-toggle');
  const rotateToggle = document.getElementById('rotate-toggle');
  const compactToggle = document.getElementById('compact-toggle');
  const stickyToggle = document.getElementById('sticky-toggle');
  const pageListTop = document.getElementById('page-list-top');
  const pageListBot = document.getElementById('page-list-bot');
  const statsTop = document.getElementById('pager-stats-top');
  const statsBot = document.getElementById('pager-stats-bot');
  document.getElementById("year").textContent = new Date().getFullYear();

  // Placeholders for images
  const LQ_PLACEHOLDER = 'data:image/svg+xml;utf8,' + encodeURIComponent(
    `<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="800"><rect width="100%" height="100%" fill="#0f1320"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="#a5b4c3" font-family="system-ui" font-size="22">image loading…</text></svg>`
  );
  const PLACEHOLDER = 'data:image/svg+xml;utf8,' + encodeURIComponent(
    `<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="800"><rect width="100%" height="100%" fill="#0f1320"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="#a5b4c3" font-family="system-ui" font-size="22">image unavailable</text></svg>`
  );

  async function fetchPlants() {
    const res = await fetch('/data/howker-plants', { headers: { 'Accept': 'application/json' } });
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    return res.json();
  }

  /* ---------- Lazy image loading via IntersectionObserver ---------- */
  let imgObserver;            // IntersectionObserver for image src swap
  function setupImgObserver(){
    if (imgObserver) imgObserver.disconnect();
    const opts = { rootMargin: '200px 0px', threshold: 0.01 };
    imgObserver = new IntersectionObserver((entries)=>{
      entries.forEach(entry=>{
        if (entry.isIntersecting){
          const img = entry.target; const real = img.getAttribute('data-src');
          if (real){ img.src = real; img.removeAttribute('data-src'); }
          imgObserver.unobserve(img);
        }
      });
    }, opts);
  }

  /* ---------- Card templating (uses data-src for lazy images) ---------- */
  function cardHTML(p){
    const src = (Array.isArray(p.imgs) && p.imgs.length ? p.imgs[0] : (p.img || PLACEHOLDER));
    const tags = (p.tags || []).slice(0, 4);
    const titleText = (p.teaser || p.desc || p.morph || '').slice(0, 160).replace(/"/g,'&quot;');
    const descText = (p.desc || '').replace(/"/g,'&quot;');
    const creditText = (p.credits || '').replace(/"/g,'&quot;');
    return `
      <div class="thumb">
        <div class="thumb-loading" aria-hidden="true"><span class="loading-spinner"></span></div>
        <img src="${LQ_PLACEHOLDER}" data-src="${src}"
             alt="${p.common} plant observed on Howker Ridge Trail"
             title="${titleText}"
             data-desc="${descText}"
             data-credits="${creditText}"
             loading="lazy" decoding="async" fetchpriority="low"
             referrerpolicy="no-referrer"
             onerror="this.onerror=null;this.src='${PLACEHOLDER}'">
        <div class="sr-only">${p.desc || p.teaser || ''}</div>
      </div>
      <div class="body">
        <h3>${p.common}</h3>
        <div class="latin">${p.latin || ''}</div>
        <div class="meta">
          ${p.type ? `<div class="meta-row"><span class="meta-label">Type</span><span class="meta-value">${p.type}</span></div>` : ''}
          ${p.habitat ? `<div class="meta-row"><span class="meta-label">Habitat</span><span class="meta-value">${p.habitat}</span></div>` : ''}
          ${p.elevation ? `<div class="meta-row"><span class="meta-label">Elevation</span><span class="meta-value">${p.elevation}</span></div>` : ''}
          ${p.bloom ? `<div class="meta-row"><span class="meta-label">Season</span><span class="meta-value">${p.bloom}</span></div>` : ''}
          ${tags.length ? `<div class="meta-row"><span class="meta-label">Tags</span><span class="meta-value"><span class="meta-tags">${tags.map(t=>`<span class="tag-pill">${t}</span>`).join("")}</span></span></div>` : ''}
        </div>
        ${p.teaser ? `<div class="teaser-block"><span class="teaser-label">Overview</span><p class="teaser">${p.teaser}</p></div>` : ''}
        <div class="more">›</div>
      </div>`;
  }

  /* ---------- RENDER (Pagination instead of infinite scroll) ---------- */
  function resetGrid(){ grid.innerHTML = ""; }

  function renderPage(){
    const total = CURRENT.length;
    const { p, start, end } = pageBounds(PAGE, PAGE_SIZE, total);
    PAGE = p; // clamp

    resetGrid();

    if (!total){
      grid.innerHTML = `<div class="empty">No plants match your filters.</div>`;
      updatePager(0, 0, 0);
      schedule();
      return;
    }

    const slice = CURRENT.slice(start, end);
    slice.forEach(p=>{
      const el = document.createElement("article");
      el.className = "card";
      el.innerHTML = cardHTML(p);
      // dataset for rotating card images
      if (p.imgs && p.imgs.length > 1) {
        el.dataset.imgs = p.imgs.join('|');
        el.dataset.idx = '0';
      }
      el.dataset.pid = p.id;
      const img = el.querySelector('img');
      if (img) {
        imgObserver && imgObserver.observe(img);
        img.addEventListener('load', () => {
          const overlay = img.previousElementSibling;
          if (overlay && overlay.classList.contains('thumb-loading')) {
            overlay.classList.add('hidden');
          }
        }, { once: true });
        img.addEventListener('load', schedule, {once:true});
      }
      // Instead of opening a drawer, redirect to details page
      el.addEventListener("click", () => {
        const id = p.id;
        window.location.href = `/plant/${encodeURIComponent(id)}`;
      });


      grid.appendChild(el);
    });

    updatePager(total, start + 1, end);

    // keep the host page in charge of scrolling: scroll to the list top
    const wrapTop = document.getElementById('howker-plants').offsetTop;
    try { window.scrollTo({ top: wrapTop, behavior: 'smooth' }); } catch(_) { window.scrollTo(0, wrapTop); }

    schedule();
  }

  function updatePlantItemList(plants){
    const plantListScript = document.querySelector('script.plant-list');
    if (!plantListScript) {
      return;
    }
    try {
      const plantItemList = JSON.parse(plantListScript.textContent);
      plantItemList.itemListElement = plants.map((plant, index) => ({
        "@type": "ListItem",
        "position": index + 1,
        "name": plant.common,
        "url": `https://nh48.info/plant/${encodeURIComponent(plant.id)}`
      }));
      plantListScript.textContent = JSON.stringify(plantItemList);
    } catch (err) {
      console.error('Failed to update plant ItemList structured data', err);
    }
  }

  /* ---------- Pagination UI ---------- */
  function updatePager(total, from, to){
    const totalPages = Math.max(1, Math.ceil(total / PAGE_SIZE) || 1);
    TOTAL_PAGES = totalPages;

    const label = total ? `Showing ${from}–${to} of ${total}` : 'No results';
    statsTop.textContent = label; statsBot.textContent = label;

    const buildButtons = (where) => {
      const host = where === 'top' ? pageListTop : pageListBot;
      host.innerHTML = '';

      const mkBtn = (txt, disabled, onClick, aria) => {
        const b = document.createElement('button');
        b.className = 'page-btn'; b.textContent = txt; b.disabled = !!disabled; if (aria) b.setAttribute('aria-label', aria);
        b.addEventListener('click', onClick);
        return b;
      };

      // First / Prev
      host.appendChild(mkBtn('«', PAGE===1, ()=>gotoPage(1), 'First page'));
      host.appendChild(mkBtn('‹', PAGE===1, ()=>gotoPage(PAGE-1), 'Previous page'));

      // Page window — show up to 7 numbers centered on current
      const windowSize = 7;
      let start = Math.max(1, PAGE - Math.floor(windowSize/2));
      let end = Math.min(totalPages, start + windowSize - 1);
      start = Math.max(1, Math.min(start, Math.max(1, end - windowSize + 1)));
      for (let i=start; i<=end; i++){
        const b = mkBtn(String(i), false, ()=>gotoPage(i));
        if (i===PAGE) b.setAttribute('aria-current','page');
        host.appendChild(b);
      }

      // Next / Last
      host.appendChild(mkBtn('›', PAGE===totalPages, ()=>gotoPage(PAGE+1), 'Next page'));
      host.appendChild(mkBtn('»', PAGE===totalPages, ()=>gotoPage(totalPages), 'Last page'));
    };

    buildButtons('top');
    buildButtons('bot');
  }

  function gotoPage(p){ PAGE = Math.max(1, Math.min(p, TOTAL_PAGES)); renderPage(); }

  /* ---------- Filtering ---------- */
  function filter(){
    const q = (qEl.value||"").toLowerCase();
    const t = typeEl.value, h = habEl.value, b = bloomEl.value;
    CURRENT = PLANTS.filter(p=>{
      const hay = [p.common,p.latin,p.type,p.habitat,(p.tags||[]).join(" "),p.teaser,p.desc].join(" ").toLowerCase();
      const okQ = !q || hay.includes(q);
      const okT = !t || p.type===t;
      const okH = !h || p.habitat===h;
      const okB = !b || p.bloom===b;
      return okQ && okT && okH && okB;
    });
    PAGE = 1; // reset to first page after filter
    renderPage();
  }

  function setHidden(id, hidden){ const el = document.getElementById(id); if (!el) return; hidden ? el.setAttribute('hidden','') : el.removeAttribute('hidden'); }

  /* ---------- Card image rotation ---------- */
  function rotateSingle(card){
    const imgs = card.dataset.imgs.split('|');
    let idx   = parseInt(card.dataset.idx || '0', 10);
    idx       = (idx + 1) % imgs.length;
    const imgEl = card.querySelector('.thumb img');
    if (imgEl) {
      imgEl.style.opacity = '0';
      setTimeout(() => {
        imgEl.src = imgs[idx];
        imgEl.removeAttribute('data-src');
        imgEl.style.opacity = '1';
      }, 250);
    }
    card.dataset.idx = idx;
  }

  function rotateCardImages(){
    const cards = document.querySelectorAll('#grid .card[data-imgs]');
    let colCount = 1;
    try {
      const cols  = getComputedStyle(grid).gridTemplateColumns;
      const parts = cols.split(' ');
      colCount    = parts.filter(p => p.trim().length > 0).length || 1;
    } catch(e) {}
    const rowDelay = 500;
    const colDelay = 200;
    cards.forEach((card, i) => {
      const row   = Math.floor(i / colCount);
      const col   = i % colCount;
      const delay = row * rowDelay + col * colDelay;
      setTimeout(() => {
        rotateSingle(card);
      }, delay);
    });
  }

  /* ---------- Step #4: Robust body scroll lock utility (off by default) ---------- */
  const BodyLock = (()=>{
    let locked = false, y = 0;
    function lock(){
      if (locked) return; locked = true;
      y = window.scrollY || window.pageYOffset || 0;
      Object.assign(document.body.style, { position:'fixed', top:`-${y}px`, width:'100%' });
    }
    function unlock(){
      if (!locked) return; locked = false;
      const restoreY = y; y = 0;
      Object.assign(document.body.style, { position:'', top:'', width:'' });
      window.scrollTo(0, restoreY);
    }
    return { lock, unlock };
  })();
  // NOTE: We keep body unlocked to avoid competing scrolls. If you ever need to lock during a modal:
  // const USE_BODY_LOCK = false; if (USE_BODY_LOCK) BodyLock.lock(); else BodyLock.unlock();

  /* ---------- Init ---------- */
  (async function init(){
    setupImgObserver();
    try{
      const items = await fetchPlants();
      PLANTS = items;
      CURRENT = PLANTS.slice();
      PAGE = 1; TOTAL_PAGES = Math.max(1, Math.ceil(CURRENT.length / PAGE_SIZE));
      updatePlantItemList(PLANTS);
      renderPage();
      // start rotating card images only if rotateToggle checked
      if (rotateToggle.checked) { rotateInterval = setInterval(rotateCardImages, 5000); }
    }catch(err){
      console.error(err);
      grid.innerHTML = `<div class="error">Couldn’t load the catalog (network ${err.message}).</div>`;
      schedule();
    }

    // Settings handlers
    themeToggle.addEventListener('change', () => {
      if (themeToggle.checked) { document.body.classList.remove('light'); }
      else { document.body.classList.add('light'); }
    });
    viewToggle.addEventListener('change', () => {
      document.body.classList.toggle('list-view', viewToggle.checked); schedule();
    });
    rotateToggle.addEventListener('change', () => {
      if (rotateToggle.checked) {
        if (!rotateInterval) rotateInterval = setInterval(rotateCardImages, 5000);
      } else {
        if (rotateInterval) { clearInterval(rotateInterval); rotateInterval = null; }
      }
    });
    compactToggle.addEventListener('change', () => {
      document.body.classList.toggle('compact', compactToggle.checked); schedule();
    });
    stickyToggle.addEventListener('change', () => {
      const headerEl = document.querySelector('header');
      headerEl.classList.toggle('sticky', stickyToggle.checked);
    });
  })();

  /* ---------- schedule() no-op hook for standalone layout ---------- */
  function schedule() {}

  /* ---------- Keyboard shortcuts for pagination ---------- */
  window.addEventListener('keydown', (e)=>{
    if (e.target && (/input|select|textarea/i).test(e.target.tagName)) return;
    if (e.key === 'ArrowRight') { gotoPage(PAGE + 1); }
    if (e.key === 'ArrowLeft')  { gotoPage(PAGE - 1); }
  });
</script>
<div id="footer-placeholder"></div>
</body>
</html>
